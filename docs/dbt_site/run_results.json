{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.7", "generated_at": "2025-08-19T17:27:13.892767Z", "invocation_id": "833a862e-818c-43d7-bc02-87b50cca712c", "invocation_started_at": "2025-08-19T17:27:11.706190Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.226229Z", "completed_at": "2025-08-19T17:27:13.238809Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.241392Z", "completed_at": "2025-08-19T17:27:13.241421Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017299652099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.oil_gas_dashboard.stg_annual_production", "compiled": true, "compiled_code": "-- Model: stg_annual_production\n-- Grain: row-level from RAW (duplicates may exist at well-year)\n-- Keep nulls; cast to concrete types; normalize codes.\n\nwith src as (\n    select * from OILGAS_DB.RAW.ANNUAL_PRODUCTION\n),\n\ncasted as (\n    select\n        -- business keys / identifiers\n        cast(\"api_well_number\" as varchar)            as api_well_number,\n        cast(\"api_hole_number\" as varchar)            as api_hole_number,\n\n        -- categorical / codes\n        upper(trim(\"well_status_code\"))               as well_status_code,\n        upper(trim(\"well_type_code\"))                 as well_type_code,\n        trim(\"company_name\")                          as company_name,\n        trim(\"county\")                                as county,\n        trim(\"town\")                                  as town,\n        trim(\"production_field\")                      as production_field,\n        trim(\"producing_formation\")                   as producing_formation,\n        trim(\"well_name\")                             as well_name,\n\n        -- numerics (RAW already typed: some are FLOAT, some are NUMBER)\n        cast(\"months_in_production\" as number(38,0))  as months_in_production,\n        cast(\"gas_produced_mcf\"      as float)        as gas_produced_mcf,\n        cast(\"water_produced_bbl\"    as float)        as water_produced_bbl,\n        cast(\"oil_produced_bbl\"      as float)        as oil_produced_bbl,\n        cast(\"reporting_year\"        as number(38,0)) as reporting_year,\n\n        -- passthrough\n        trim(\"new_georeferenced_column\")              as new_georeferenced_column\n    from src\n)\n\nselect * from casted", "relation_name": "OILGAS_DB.STAGING.stg_annual_production", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.242698Z", "completed_at": "2025-08-19T17:27:13.244322Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.248234Z", "completed_at": "2025-08-19T17:27:13.248261Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011713981628417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.oil_gas_dashboard.refdata_well_status_codes", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.245070Z", "completed_at": "2025-08-19T17:27:13.246977Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.249794Z", "completed_at": "2025-08-19T17:27:13.249814Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012152910232543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.oil_gas_dashboard.refdata_well_type_codes", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.337181Z", "completed_at": "2025-08-19T17:27:13.352985Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.354752Z", "completed_at": "2025-08-19T17:27:13.354763Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09867095947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.accepted_values_stg_annual_production_well_type_code__True__GD__OD__NL.66d77794ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        well_type_code as value_field,\n        count(*) as n_records\n\n    from OILGAS_DB.STAGING.stg_annual_production\n    group by well_type_code\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'GD','OD','NL'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.260908Z", "completed_at": "2025-08-19T17:27:13.353308Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.355378Z", "completed_at": "2025-08-19T17:27:13.355386Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10106801986694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.oil_gas_dashboard.int_annual_production_dedup", "compiled": true, "compiled_code": "/*\n  Model: int_annual_production_dedup\n  Layer: MARTS (INT)\n  Grain: (api_well_number, reporting_year)\n\n  Business rules:\n    - Aggregate measures by well-year:\n        * SUM(oil_produced_bbl, gas_produced_mcf, water_produced_bbl) with COALESCE(0)\n        * MAX(months_in_production), then cap to 12\n    - Representative attributes from row with highest months_in_production\n      (tie-break by higher (oil+gas+water) and non-null attributes)\n    - Keep helper field: records_aggregated\n*/\n\n\n\nwith base as (\n    select *\n    from OILGAS_DB.STAGING.stg_annual_production\n),\n\nagg as (\n    select\n        api_well_number,\n        reporting_year,\n        sum(coalesce(oil_produced_bbl, 0))  as oil_produced_bbl,\n        sum(coalesce(gas_produced_mcf, 0))  as gas_produced_mcf,\n        sum(coalesce(water_produced_bbl, 0)) as water_produced_bbl,\n        max(months_in_production)           as months_in_production_raw,\n        -- cap to 12 for business logic\n        least(12, max(coalesce(months_in_production, 0))) as months_in_production,\n        count(*) as records_aggregated\n    from base\n    group by 1,2\n),\n\nranked as (\n    select\n        b.*,\n        -- tie-break rules:\n        --   1) higher months_in_production (NULLS LAST)\n        --   2) higher sum of measures\n        --   3) presence of descriptive attributes (non-null first)\n        row_number() over (\n            partition by b.api_well_number, b.reporting_year\n            order by\n                b.months_in_production desc nulls last,\n                (coalesce(b.oil_produced_bbl,0) + coalesce(b.gas_produced_mcf,0) + coalesce(b.water_produced_bbl,0)) desc,\n                case when b.well_name              is not null then 0 else 1 end,\n                case when b.company_name           is not null then 0 else 1 end,\n                case when b.production_field       is not null then 0 else 1 end,\n                case when b.producing_formation    is not null then 0 else 1 end\n        ) as pick_rank\n    from base b\n),\n\nrep as (\n    select\n        api_well_number,\n        reporting_year,\n        well_status_code,\n        well_type_code,\n        company_name,\n        county,\n        town,\n        production_field,\n        producing_formation,\n        well_name,\n        new_georeferenced_column\n    from ranked\n    where pick_rank = 1\n)\n\nselect\n    a.api_well_number,\n    a.reporting_year,\n    a.months_in_production,         -- capped 0..12\n    a.oil_produced_bbl,\n    a.gas_produced_mcf,\n    a.water_produced_bbl,\n    r.well_status_code,\n    r.well_type_code,\n    r.company_name,\n    r.county,\n    r.town,\n    r.production_field,\n    r.producing_formation,\n    r.well_name,\n    r.new_georeferenced_column,\n    a.records_aggregated\nfrom agg a\nleft join rep r\n  on r.api_well_number = a.api_well_number\n and r.reporting_year  = a.reporting_year", "relation_name": "OILGAS_DB.MARTS.int_annual_production_dedup", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.348956Z", "completed_at": "2025-08-19T17:27:13.353786Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.356010Z", "completed_at": "2025-08-19T17:27:13.356019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09921026229858398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.between_inclusive_stg_annual_production_months_in_production__12__0.78249d6c28", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere months_in_production < 0\n   or months_in_production > 12\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.267764Z", "completed_at": "2025-08-19T17:27:13.354345Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.356576Z", "completed_at": "2025-08-19T17:27:13.356583Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10149669647216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.accepted_values_stg_annual_production_well_status_code__True__AC__IN__NR__PA__VP.1c78967764", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        well_status_code as value_field,\n        count(*) as n_records\n\n    from OILGAS_DB.STAGING.stg_annual_production\n    group by well_status_code\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'AC','IN','NR','PA','VP'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.363551Z", "completed_at": "2025-08-19T17:27:13.386880Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.390095Z", "completed_at": "2025-08-19T17:27:13.390115Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030730247497558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.max_null_proportion_stg_annual_production_gas_produced_mcf__0_6.4a1e7e6b14", "compiled": true, "compiled_code": "\nwith stats as (\n  select\n    count(*) as total_rows,\n    sum(case when gas_produced_mcf is null then 1 else 0 end) as null_rows\n  from OILGAS_DB.STAGING.stg_annual_production\n),\nviol as (\n  select\n    total_rows, null_rows,\n    null_rows::float / null_rows::float + (total_rows - null_rows)::float as dummy -- avoid division by zero on compile\n  from stats\n),\nratio as (\n  select\n    total_rows,\n    null_rows,\n    case when total_rows = 0 then 0.0 else null_rows::float / total_rows::float end as null_ratio\n  from stats\n)\nselect *\nfrom ratio\nwhere null_ratio > 0.6\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.369226Z", "completed_at": "2025-08-19T17:27:13.387699Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.391297Z", "completed_at": "2025-08-19T17:27:13.391319Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0314328670501709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.max_null_proportion_stg_annual_production_oil_produced_bbl__0_6.39aac41d5b", "compiled": true, "compiled_code": "\nwith stats as (\n  select\n    count(*) as total_rows,\n    sum(case when oil_produced_bbl is null then 1 else 0 end) as null_rows\n  from OILGAS_DB.STAGING.stg_annual_production\n),\nviol as (\n  select\n    total_rows, null_rows,\n    null_rows::float / null_rows::float + (total_rows - null_rows)::float as dummy -- avoid division by zero on compile\n  from stats\n),\nratio as (\n  select\n    total_rows,\n    null_rows,\n    case when total_rows = 0 then 0.0 else null_rows::float / total_rows::float end as null_ratio\n  from stats\n)\nselect *\nfrom ratio\nwhere null_ratio > 0.6\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.374761Z", "completed_at": "2025-08-19T17:27:13.388667Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.392358Z", "completed_at": "2025-08-19T17:27:13.392369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03204488754272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.max_null_proportion_stg_annual_production_water_produced_bbl__0_6.b4ed4ca74d", "compiled": true, "compiled_code": "\nwith stats as (\n  select\n    count(*) as total_rows,\n    sum(case when water_produced_bbl is null then 1 else 0 end) as null_rows\n  from OILGAS_DB.STAGING.stg_annual_production\n),\nviol as (\n  select\n    total_rows, null_rows,\n    null_rows::float / null_rows::float + (total_rows - null_rows)::float as dummy -- avoid division by zero on compile\n  from stats\n),\nratio as (\n  select\n    total_rows,\n    null_rows,\n    case when total_rows = 0 then 0.0 else null_rows::float / total_rows::float end as null_ratio\n  from stats\n)\nselect *\nfrom ratio\nwhere null_ratio > 0.6\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.379923Z", "completed_at": "2025-08-19T17:27:13.389305Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.393268Z", "completed_at": "2025-08-19T17:27:13.393280Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03271031379699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_future_year_stg_annual_production_reporting_year.059f3c342a", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere reporting_year > date_part(year, current_date())\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.410814Z", "completed_at": "2025-08-19T17:27:13.432748Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.434174Z", "completed_at": "2025-08-19T17:27:13.434191Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03552889823913574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_stg_annual_production_oil_produced_bbl.8da9fd2b6f", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere oil_produced_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.404164Z", "completed_at": "2025-08-19T17:27:13.433295Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.436375Z", "completed_at": "2025-08-19T17:27:13.436389Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03866934776306152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_stg_annual_production_gas_produced_mcf.a4b4679966", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere gas_produced_mcf < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.415766Z", "completed_at": "2025-08-19T17:27:13.435218Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.437921Z", "completed_at": "2025-08-19T17:27:13.437932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03845715522766113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_stg_annual_production_water_produced_bbl.261130ffbe", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere water_produced_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.422264Z", "completed_at": "2025-08-19T17:27:13.435775Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.438798Z", "completed_at": "2025-08-19T17:27:13.438811Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03860330581665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_stg_annual_production_api_well_number.7a5192240b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect api_well_number\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere api_well_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.445310Z", "completed_at": "2025-08-19T17:27:13.457933Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.463025Z", "completed_at": "2025-08-19T17:27:13.463040Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022639751434326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_stg_annual_production_reporting_year.ea17de0193", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reporting_year\nfrom OILGAS_DB.STAGING.stg_annual_production\nwhere reporting_year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.451590Z", "completed_at": "2025-08-19T17:27:13.464007Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.466785Z", "completed_at": "2025-08-19T17:27:13.466799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02461099624633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.oil_gas_dashboard.dim_well", "compiled": true, "compiled_code": "/*\n  Model: dim_well\n  Layer: MARTS (DIM)\n  Grain: one row per api_well_number (well)\n  Source: int_annual_production_dedup (well-year aggregates)\n\n  Business rules:\n    - One record per well (api_well_number).\n    - Representative attributes are picked from the row with:\n        1) highest months_in_production (already capped at 12 in INT)\n        2) highest sum(oil+gas+water)\n        3) most recent reporting_year\n    - Lifetime measures are totals across all years.\n    - Join seeds to enrich status/type descriptions.\n    - well_sk is a deterministic hash of api_well_number.\n*/\n\n\n\nwith src as (\n    select *\n    from OILGAS_DB.MARTS.int_annual_production_dedup\n),\n\nmeasures_per_well as (\n    select\n        api_well_number,\n        min(reporting_year) as first_year,\n        max(reporting_year) as last_year,\n        sum(coalesce(oil_produced_bbl,   0)) as lifetime_oil_bbl,\n        sum(coalesce(gas_produced_mcf,   0)) as lifetime_gas_mcf,\n        sum(coalesce(water_produced_bbl, 0)) as lifetime_water_bbl\n    from src\n    group by 1\n),\n\nranked as (\n    select\n        s.*,\n        -- tie-break order:\n        row_number() over (\n            partition by s.api_well_number\n            order by\n                s.months_in_production desc nulls last,\n                (coalesce(s.oil_produced_bbl,0) + coalesce(s.gas_produced_mcf,0) + coalesce(s.water_produced_bbl,0)) desc,\n                s.reporting_year desc\n        ) as pick_rank\n    from src s\n),\n\nrep as (\n    select\n        api_well_number,\n        well_status_code,\n        well_type_code,\n        company_name,\n        county,\n        town,\n        production_field,\n        producing_formation,\n        well_name,\n        new_georeferenced_column\n    from ranked\n    where pick_rank = 1\n),\n\njoined as (\n    select\n        -- deterministic surrogate key (hex string)\n        lower(to_varchar(md5(cast(r.api_well_number as string)))) as well_sk,\n        r.api_well_number,\n        m.first_year,\n        m.last_year,\n        m.lifetime_oil_bbl,\n        m.lifetime_gas_mcf,\n        m.lifetime_water_bbl,\n\n        -- representative attributes\n        r.well_status_code,\n        coalesce(sc.status_desc, 'Unknown / Not Applicable') as well_status_desc,\n        r.well_type_code,\n        coalesce(tc.type_desc,   'Unknown / Other')          as well_type_desc,\n        r.company_name,\n        r.county,\n        r.town,\n        r.production_field,\n        r.producing_formation,\n        r.well_name,\n        r.new_georeferenced_column\n    from rep r\n    join measures_per_well m\n      on m.api_well_number = r.api_well_number\n    left join OILGAS_DB.MARTS.refdata_well_status_codes sc\n      on sc.status_code = r.well_status_code\n    left join OILGAS_DB.MARTS.refdata_well_type_codes tc\n      on tc.type_code = r.well_type_code\n)\n\nselect * from joined", "relation_name": "OILGAS_DB.MARTS.dim_well", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.455449Z", "completed_at": "2025-08-19T17:27:13.464594Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.467614Z", "completed_at": "2025-08-19T17:27:13.467625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02423715591430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.oil_gas_dashboard.dim_year", "compiled": true, "compiled_code": "/*\n  Model: dim_year\n  Layer: MARTS (DIM)\n  Grain: one row per reporting year present in INT\n  Source: int_annual_production_dedup (distinct reporting_year)\n\n  Notes:\n  - year_sk doubles as the business key (reporting_year).\n  - Flags are handy for BI filters (current year / recent years / decade).\n*/\n\n\n\nwith years as (\n    select distinct\n        cast(reporting_year as number(38,0)) as year_sk\n    from OILGAS_DB.MARTS.int_annual_production_dedup\n    where reporting_year is not null\n),\n\nfinal as (\n    select\n        year_sk,\n        year_sk                                              as year,\n        /* Snowflake date functions for dynamic flags */\n        case when year_sk = date_part('year', current_date()) then true else false end as is_current_year,\n        case when year_sk >= date_part('year', current_date()) - 4 then true else false end as is_last_5_years,\n        /* Decade helpers */\n        floor(year_sk/10)*10                                 as decade_start,\n        to_varchar(floor(year_sk/10)*10) || 's'              as decade_label\n    from years\n)\n\nselect * from final", "relation_name": "OILGAS_DB.MARTS.dim_year", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.458402Z", "completed_at": "2025-08-19T17:27:13.466226Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.469214Z", "completed_at": "2025-08-19T17:27:13.469225Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025223493576049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.between_inclusive_int_annual_production_dedup_months_in_production__12__0.9237fada20", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere months_in_production < 0\n   or months_in_production > 12\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.474584Z", "completed_at": "2025-08-19T17:27:13.479928Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.489540Z", "completed_at": "2025-08-19T17:27:13.489549Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021053075790405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.int_annual_production_dedup_unique", "compiled": true, "compiled_code": "-- Fails if there are duplicate well-year rows after dedup\nselect\n  api_well_number,\n  reporting_year\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\ngroup by 1,2\nhaving count(*) > 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.480360Z", "completed_at": "2025-08-19T17:27:13.490218Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.491819Z", "completed_at": "2025-08-19T17:27:13.491825Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019244670867919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_int_annual_production_dedup_gas_produced_mcf.be7fafe6f0", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere gas_produced_mcf < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.483748Z", "completed_at": "2025-08-19T17:27:13.491176Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.492730Z", "completed_at": "2025-08-19T17:27:13.492736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01899552345275879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_int_annual_production_dedup_oil_produced_bbl.3033096f42", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere oil_produced_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.486504Z", "completed_at": "2025-08-19T17:27:13.491534Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.493227Z", "completed_at": "2025-08-19T17:27:13.493233Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015507221221923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_int_annual_production_dedup_water_produced_bbl.c796b7c78c", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere water_produced_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.495408Z", "completed_at": "2025-08-19T17:27:13.503010Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.508101Z", "completed_at": "2025-08-19T17:27:13.508110Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01588749885559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_int_annual_production_dedup_api_well_number.84d537902a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect api_well_number\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere api_well_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.500529Z", "completed_at": "2025-08-19T17:27:13.508636Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.510055Z", "completed_at": "2025-08-19T17:27:13.510062Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015105247497558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_int_annual_production_dedup_reporting_year.b28b57f1d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reporting_year\nfrom OILGAS_DB.MARTS.int_annual_production_dedup\nwhere reporting_year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.503301Z", "completed_at": "2025-08-19T17:27:13.509120Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.510610Z", "completed_at": "2025-08-19T17:27:13.510617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011763572692871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_dim_well_lifetime_gas_mcf.12227b98f0", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.dim_well\nwhere lifetime_gas_mcf < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.505630Z", "completed_at": "2025-08-19T17:27:13.509758Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.511399Z", "completed_at": "2025-08-19T17:27:13.511405Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012172222137451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_dim_well_lifetime_oil_bbl.b907d7973c", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.dim_well\nwhere lifetime_oil_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.513745Z", "completed_at": "2025-08-19T17:27:13.517319Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.525050Z", "completed_at": "2025-08-19T17:27:13.525058Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0140228271484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.non_negative_dim_well_lifetime_water_bbl.4cb9ca880a", "compiled": true, "compiled_code": "\nselect *\nfrom OILGAS_DB.MARTS.dim_well\nwhere lifetime_water_bbl < 0\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.517626Z", "completed_at": "2025-08-19T17:27:13.525772Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.526813Z", "completed_at": "2025-08-19T17:27:13.526819Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013755083084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_well_api_well_number.3011ce0cc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect api_well_number\nfrom OILGAS_DB.MARTS.dim_well\nwhere api_well_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.520124Z", "completed_at": "2025-08-19T17:27:13.526504Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.528020Z", "completed_at": "2025-08-19T17:27:13.528028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01466059684753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_well_first_year.e3273e6325", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect first_year\nfrom OILGAS_DB.MARTS.dim_well\nwhere first_year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.522531Z", "completed_at": "2025-08-19T17:27:13.527317Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.528808Z", "completed_at": "2025-08-19T17:27:13.528814Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012814521789550781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_well_last_year.53dd41d318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_year\nfrom OILGAS_DB.MARTS.dim_well\nwhere last_year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.530762Z", "completed_at": "2025-08-19T17:27:13.537114Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.540618Z", "completed_at": "2025-08-19T17:27:13.540629Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01301121711730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_well_well_sk.9fa5a88a7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect well_sk\nfrom OILGAS_DB.MARTS.dim_well\nwhere well_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.534710Z", "completed_at": "2025-08-19T17:27:13.544791Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.546840Z", "completed_at": "2025-08-19T17:27:13.546854Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016832828521728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_year_decade_start.437102a02b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect decade_start\nfrom OILGAS_DB.MARTS.dim_year\nwhere decade_start is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.537889Z", "completed_at": "2025-08-19T17:27:13.545900Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.548218Z", "completed_at": "2025-08-19T17:27:13.548225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014992713928222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_year_year.4b720527c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom OILGAS_DB.MARTS.dim_year\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.541329Z", "completed_at": "2025-08-19T17:27:13.546484Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.548715Z", "completed_at": "2025-08-19T17:27:13.548722Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014762163162231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.not_null_dim_year_year_sk.070a15d6f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year_sk\nfrom OILGAS_DB.MARTS.dim_year\nwhere year_sk is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.551295Z", "completed_at": "2025-08-19T17:27:13.558622Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.569231Z", "completed_at": "2025-08-19T17:27:13.569239Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02147960662841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.relationships_dim_well_well_status_code__status_code__ref_refdata_well_status_codes_.e6a4f43120", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select well_status_code as from_field\n    from OILGAS_DB.MARTS.dim_well\n    where well_status_code is not null\n),\n\nparent as (\n    select status_code as to_field\n    from OILGAS_DB.MARTS.refdata_well_status_codes\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.558908Z", "completed_at": "2025-08-19T17:27:13.569914Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.571013Z", "completed_at": "2025-08-19T17:27:13.571020Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020106077194213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.relationships_dim_well_well_type_code__type_code__ref_refdata_well_type_codes_.138a8b30ef", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select well_type_code as from_field\n    from OILGAS_DB.MARTS.dim_well\n    where well_type_code is not null\n),\n\nparent as (\n    select type_code as to_field\n    from OILGAS_DB.MARTS.refdata_well_type_codes\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.562542Z", "completed_at": "2025-08-19T17:27:13.570627Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.572230Z", "completed_at": "2025-08-19T17:27:13.572240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01537775993347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.unique_dim_well_api_well_number.7dd5d802cd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    api_well_number as unique_field,\n    count(*) as n_records\n\nfrom OILGAS_DB.MARTS.dim_well\nwhere api_well_number is not null\ngroup by api_well_number\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.566590Z", "completed_at": "2025-08-19T17:27:13.571530Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.572909Z", "completed_at": "2025-08-19T17:27:13.572916Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01567530632019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.unique_dim_well_well_sk.83aec50660", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    well_sk as unique_field,\n    count(*) as n_records\n\nfrom OILGAS_DB.MARTS.dim_well\nwhere well_sk is not null\ngroup by well_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-19T17:27:13.573743Z", "completed_at": "2025-08-19T17:27:13.576195Z"}, {"name": "execute", "started_at": "2025-08-19T17:27:13.576508Z", "completed_at": "2025-08-19T17:27:13.576519Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004748344421386719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.oil_gas_dashboard.unique_dim_year_year_sk.9c7ef9c661", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    year_sk as unique_field,\n    count(*) as n_records\n\nfrom OILGAS_DB.MARTS.dim_year\nwhere year_sk is not null\ngroup by year_sk\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.4646153450012207, "args": {"static_parser": true, "require_all_warnings_handled_by_warn_error": false, "write_json": true, "send_anonymous_usage_stats": true, "project_dir": "/home/rolando/proyectos/oil-gas-dashboard", "require_generic_test_arguments_property": false, "select": [], "state_modified_compare_more_unrendered_values": false, "use_fast_test_edges": false, "vars": {}, "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format": "default", "empty_catalog": false, "exclude": [], "log_level": "info", "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "source_freshness_run_project_hooks": true, "quiet": false, "require_resource_names_without_spaces": true, "invocation_command": "dbt docs generate", "partial_parse_file_diff": true, "use_colors": true, "log_level_file": "debug", "version_check": true, "print": true, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "macro_debugging": false, "target_path": "/home/rolando/proyectos/oil-gas-dashboard/dbt/target", "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "which": "generate", "favor_state": false, "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "log_file_max_bytes": 10485760, "compile": true, "populate_cache": true, "cache_selected_only": false, "profiles_dir": "/home/rolando/proyectos/oil-gas-dashboard/dbt", "show_resource_report": false, "log_format_file": "debug", "strict_mode": false, "defer": false, "use_colors_file": true, "log_path": "/home/rolando/proyectos/oil-gas-dashboard/dbt/logs", "show_all_deprecations": false, "static": false}}
